<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Secure File Share</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <style>
        /* Small, unobtrusive custom styles to improve professionalism */
        body { background-color: #f8fafc; color: #0f172a; }
        .brand { letter-spacing: 0.4px; font-weight: 600; }
        .upload-card { max-width: 680px; margin: 0 auto; }
        .file-actions a { margin-left: .4rem; }
        .muted { color: #64748b; }
    </style>
</head>

<body>
    <header class="py-4 bg-white shadow-sm">
        <div class="container d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center">
                <div class="me-3">
                    <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <rect width="24" height="24" rx="4" fill="#0ea5a4" />
                        <path d="M7 12l3 3 7-7" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div>
                    <div class="h5 mb-0 brand">ðŸ”’ Secure File Sharing</div>
                    <div class="small muted">Upload, encrypt and securely share files</div>
                </div>
            </div>
            <nav class="small muted">
                Built with Flask Â· Minimal, secure
            </nav>
        </div>
    </header>

    <main class="container py-5">
        <div class="upload-card card p-4 mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <div>
                    <h2 class="h5 mb-0">Upload & Encrypt</h2>
                    <div class="small muted">Select a file to upload. Files are encrypted on the server before storage.</div>
                </div>
            </div>

            <form method="post" enctype="multipart/form-data" class="row g-2 align-items-center">
                <div class="col-12 col-md-8">
                    <label for="fileInput" class="visually-hidden">Choose file</label>
                    <input id="fileInput" type="file" name="file" class="form-control">
                </div>
                <div class="col-12 col-md-4 d-grid">
                    <button type="submit" class="btn btn-primary">Upload & Encrypt</button>
                </div>
            </form>

            {% with messages = get_flashed_messages() %}
            {% if messages %}
            <div class="alert alert-info mt-3 mb-0" role="status">
                {{ messages[0] }}
            </div>
            {% endif %}
            {% endwith %}
        </div>

        <section class="card p-3">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3 class="h6 mb-0">Available Files</h3>
                <div class="small muted">Total: {{ files|length }}</div>
            </div>

            <ul class="list-group list-group-flush">
                {% for file in files %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <div class="d-flex align-items-center">
                        <svg class="me-3" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="#0f172a" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M14 2v6h6" stroke="#0f172a" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <div>
                            <div>{{ file }}</div>
                            <div class="small muted">Uploaded: â€”</div>
                        </div>
                    </div>

                    <div class="file-actions">
                        <a href="{{ url_for('download_encrypted', filename=file) }}" class="btn btn-outline-secondary btn-sm" title="Download encrypted">
                            Encrypted
                        </a>
                        <a href="{{ url_for('download_decrypt', filename=file) }}" class="btn btn-success btn-sm" title="Download and decrypt">
                            Decrypt
                        </a>
                    </div>
                </li>
                {% else %}
                <li class="list-group-item">No files have been uploaded yet.</li>
                {% endfor %}
            </ul>
        </section>
    </main>

    <footer class="py-3 text-center small muted">
        <div class="container">Â© {{ current_year or "" }} Secure File Share â€” Keep your files private</div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>